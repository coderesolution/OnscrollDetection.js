{"version":3,"file":"OnscrollDetection.modern.mjs","sources":["../src/index.js"],"sourcesContent":["export default class OnscrollDetection {\n\tconstructor(options = {}) {\n\t\tthis.elements = options.elements || '[data-onscroll]'\n\t\tthis.scrollTriggers = []\n\t\tthis.animationsData = [];\n\t\tthis.init()\n\t}\n\n\tinit = () => {\n\t\t/**\n\t\t * Loop each element\n\t\t */\n\t\tgsap.utils.toArray(this.elements).forEach((oElement, iIndex) => {\n\t\t\t/* Defaults */\n\t\t\tlet oTrigger,\n\t\t\t\tiOffset = null,\n\t\t\t\tiDistance = null,\n\t\t\t\tiStart = 'top bottom',\n\t\t\t\tiBottom = 'bottom top'\n\n\t\t\t/* Assign scroll trigger to element */\n\t\t\toTrigger = oElement\n\n\t\t\t/* Determine custom from->to properties */\n\t\t\tlet aAnimateFrom = [],\n\t\t\t\taAnimateTo = []\n\n\t\t\tif (oElement.hasAttribute('data-onscroll-from')) {\n\t\t\t\taAnimateFrom = JSON.parse(oElement.dataset.onscrollFrom)\n\t\t\t}\n\n\t\t\tif (oElement.hasAttribute('data-onscroll-to')) {\n\t\t\t\taAnimateTo = JSON.parse(oElement.dataset.onscrollTo)\n\t\t\t}\n\n\t\t\t/* Set offset */\n\t\t\tif (oElement.hasAttribute('data-onscroll-offset')) {\n\t\t\t\tiOffset = parseInt(oElement.dataset.onscrollOffset)\n\t\t\t}\n\n\t\t\t/* Set distance */\n\t\t\tif (oElement.hasAttribute('data-onscroll-distance')) {\n\t\t\t\tiDistance = parseInt(oElement.dataset.onscrollDistance)\n\t\t\t}\n\n\t\t\t/* Get speed */\n\t\t\tconst fnGetSpeed = () => {\n\t\t\t\treturn (\n\t\t\t\t\t(1 - parseFloat(oElement.dataset.onscrollSpeed)) *\n\t\t\t\t\t(ScrollTrigger.maxScroll(window) - (this.scrollTrigger ? this.scrollTrigger.start : 0))\n\t\t\t\t)\n\t\t\t}\n\n\t\t\t/* Determine auto */\n\t\t\tif (oElement.hasAttribute('data-onscroll-auto')) {\n\t\t\t\toTrigger = oElement.parentElement\n\t\t\t\tiDistance = oElement.offsetHeight - oElement.parentElement.offsetHeight\n\t\t\t}\n\n\t\t\t/* Get offset */\n\t\t\tfunction fnGetOffset() {\n\t\t\t\tif (oElement.hasAttribute('data-onscroll-reverse')) {\n\t\t\t\t\treturn iOffset ? +iOffset : null\n\t\t\t\t} else {\n\t\t\t\t\treturn iOffset ? -iOffset : null\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Get distance */\n\t\t\tfunction fnGetDistance() {\n\t\t\t\tif (oElement.hasAttribute('data-onscroll-auto')) {\n\t\t\t\t\treturn oElement.hasAttribute('data-onscroll-reverse') ? -iDistance : iDistance\n\t\t\t\t} else {\n\t\t\t\t\treturn oElement.hasAttribute('data-onscroll-reverse') ? -iDistance : iDistance\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Apply animations */\n\t\t\tconst fromProperties = {\n\t\t\t\t...aAnimateFrom,\n\t\t\t\tbottom:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-auto') && oElement.hasAttribute('data-onscroll-reverse')\n\t\t\t\t\t\t? 'auto'\n\t\t\t\t\t\t: null,\n\t\t\t\ttop:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-auto') && !oElement.hasAttribute('data-onscroll-reverse')\n\t\t\t\t\t\t? 'auto'\n\t\t\t\t\t\t: null,\n\t\t\t\tx:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t(oElement.dataset.onscrollDirection === 'x' || oElement.dataset.onscrollDirection === 'xy')\n\t\t\t\t\t\t? fnGetOffset()\n\t\t\t\t\t\t: null,\n\t\t\t\ty:\n\t\t\t\t\t!oElement.hasAttribute('data-onscroll-direction') ||\n\t\t\t\t\t(oElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'y' || oElement.dataset.onscrollDirection === 'xy'))\n\t\t\t\t\t\t? fnGetOffset()\n\t\t\t\t\t\t: null,\n\t\t\t};\n\n\t\t\tconst toProperties = {\n\t\t\t\t...aAnimateTo,\n\t\t\t\tx: () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\toElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'x' || oElement.dataset.onscrollDirection === 'xy')\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (oElement.hasAttribute('data-onscroll-speed')) {\n\t\t\t\t\t\t\treturn fnGetSpeed()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn fnGetDistance()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ty: () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!oElement.hasAttribute('data-onscroll-direction') ||\n\t\t\t\t\t\t(oElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'y' ||\n\t\t\t\t\t\t\t\toElement.dataset.onscrollDirection === 'xy'))\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (oElement.hasAttribute('data-onscroll-speed')) {\n\t\t\t\t\t\t\treturn fnGetSpeed()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn fnGetDistance()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tease: 'none',\n\t\t\t\tscrollTrigger: {\n\t\t\t\t\ttrigger: oElement.dataset.onscrollTrigger\n\t\t\t\t\t\t? document.querySelector(oElement.dataset.onscrollTrigger)\n\t\t\t\t\t\t: oTrigger,\n\t\t\t\t\tstart: oElement.dataset.onscrollStart ? oElement.dataset.onscrollStart : iStart,\n\t\t\t\t\tend: oElement.dataset.onscrollEnd ? oElement.dataset.onscrollEnd : iBottom,\n\t\t\t\t\tinvalidateOnRefresh: true,\n\t\t\t\t\tscrub: true,\n\t\t\t\t\tmarkers: oElement.hasAttribute('data-onscroll-debug') ? true : false,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst animation = gsap.fromTo( oElement, fromProperties, toProperties )\n\n\t\t\t/* Store the ScrollTrigger instance and animation */\n\t\t\tthis.scrollTriggers.push(animation.scrollTrigger);\n\t\t\tthis.animationsData.push({ oElement, fromProperties, toProperties });\n\n\t\t\t/* Debug */\n\t\t\tif (oElement.hasAttribute('data-onscroll-debug')) {\n\t\t\t\tconsole.group(`uOnscrollDetection() debug instance (${iIndex + 1})`)\n\t\t\t\tconsole.log({\n\t\t\t\t\telement: oElement,\n\t\t\t\t\tauto: oElement.hasAttribute('data-onscroll-auto') ? true : false,\n\t\t\t\t\toffset: iOffset,\n\t\t\t\t\tdistance: iDistance,\n\t\t\t\t\tspeed: oElement.hasAttribute('data-onscroll-speed')\n\t\t\t\t\t\t? oElement.dataset.onscrollSpeed +\n\t\t\t\t\t\t  ' calculated at ' +\n\t\t\t\t\t\t  (1 - parseFloat(oElement.dataset.onscrollSpeed)) *\n\t\t\t\t\t\t\t\t(ScrollTrigger.maxScroll(window) - (this.scrollTrigger ? this.scrollTrigger.start : 0))\n\t\t\t\t\t\t: null,\n\t\t\t\t\tdirection: oElement.hasAttribute('data-onscroll-direction')\n\t\t\t\t\t\t? oElement.dataset.onscrollDirection\n\t\t\t\t\t\t: 'y',\n\t\t\t\t\treverse: oElement.hasAttribute('data-onscroll-reverse') ? true : false,\n\t\t\t\t\ttrigger: oTrigger,\n\t\t\t\t\ttriggerStart: iStart,\n\t\t\t\t\ttriggerEnd: iBottom,\n\t\t\t\t\tanimateFrom: oElement.hasAttribute('data-onscroll-to')\n\t\t\t\t\t\t? JSON.parse(oElement.dataset.onscrollFrom)\n\t\t\t\t\t\t: null,\n\t\t\t\t\tanimateTo: oElement.hasAttribute('data-onscroll-to')\n\t\t\t\t\t\t? JSON.parse(oElement.dataset.onscrollTo)\n\t\t\t\t\t\t: null,\n\t\t\t\t})\n\t\t\t\tconsole.groupEnd()\n\t\t\t}\n\t\t})\n\t}\n\n\trefresh() {\n\t\tScrollTrigger.refresh()\n\t}\n\n\tstop(target = null) {\n\t\tif (target) {\n\t\t\tconst index = this.scrollTriggers.indexOf(target)\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.scrollTriggers[index].kill()\n\t\t\t\tthis.scrollTriggers.splice(index, 1)\n\t\t\t}\n\t\t} else {\n\t\t\tthis.scrollTriggers.forEach((st) => {\n\t\t\t\tst.kill()\n\t\t\t})\n\t\t\tthis.scrollTriggers = [] // Clear the ScrollTrigger instances array\n\t\t}\n\t}\n\n\trestart() {\n\t\t// Remove existing ScrollTriggers\n\t\tthis.stop();\n\n\t\t// Reapply animations using the stored animation properties\n\t\tthis.animationsData.forEach(({ oElement, fromProperties, toProperties }) => {\n\t\t\tconst animation = gsap.fromTo(oElement, fromProperties, toProperties);\n\t\t\tthis.scrollTriggers.push(animation.scrollTrigger);\n\t\t});\n\t}\n}\n"],"names":["OnscrollDetection","constructor","options","this","init","gsap","utils","toArray","elements","forEach","oElement","iIndex","oTrigger","iOffset","iDistance","iStart","iBottom","aAnimateFrom","aAnimateTo","hasAttribute","JSON","parse","dataset","onscrollFrom","onscrollTo","parseInt","onscrollOffset","onscrollDistance","fnGetSpeed","parseFloat","onscrollSpeed","ScrollTrigger","maxScroll","window","scrollTrigger","start","fnGetOffset","fnGetDistance","parentElement","offsetHeight","fromProperties","_extends","bottom","top","x","onscrollDirection","y","toProperties","ease","trigger","onscrollTrigger","document","querySelector","onscrollStart","end","onscrollEnd","invalidateOnRefresh","scrub","markers","animation","fromTo","scrollTriggers","push","animationsData","console","group","log","element","auto","offset","distance","speed","direction","reverse","triggerStart","triggerEnd","animateFrom","animateTo","groupEnd","refresh","stop","target","index","indexOf","kill","splice","st","restart"],"mappings":"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"}