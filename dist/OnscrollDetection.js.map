{"version":3,"file":"OnscrollDetection.js","sources":["../src/index.js"],"sourcesContent":["export default class OnscrollDetection {\n\tconstructor(options = {}) {\n\t\tthis.elements = options.elements || '[data-onscroll]'\n\t\tthis.screen = options.screen || '(min-width: 768px)'\n\t\tthis.scrollTriggers = []\n\t\tthis.animationsData = []\n\t\tthis.init()\n\t}\n\n\tinit = () => {\n\t\t/**\n\t\t * Loop each element\n\t\t */\n\t\tgsap.utils.toArray(this.elements).forEach((oElement, iIndex) => {\n\t\t\t/* Defaults */\n\t\t\tlet oTrigger,\n\t\t\t\tgsapAnimation = null,\n\t\t\t\taAnimateFrom = [],\n\t\t\t\taAnimateTo = [],\n\t\t\t\tiOffset = null,\n\t\t\t\tiDistance = null,\n\t\t\t\tiStart = 'top bottom',\n\t\t\t\tiBottom = 'bottom top',\n\t\t\t\tsScreen = this.screen,\n\t\t\t\tmatchMedia = gsap.matchMedia()\n\n\t\t\t/* Assign scroll trigger to element */\n\t\t\toTrigger = oElement\n\n\t\t\t/* Update media query conditions if they exist */\n\t\t\tif (oElement.hasAttribute('data-onscroll-screen')) {\n\t\t\t\tsScreen = oElement.dataset.onscrollScreen\n\t\t\t}\n\n\t\t\t/* Determine custom from->to properties */\n\t\t\tif (oElement.hasAttribute('data-onscroll-from')) {\n\t\t\t\taAnimateFrom = JSON.parse(oElement.dataset.onscrollFrom)\n\t\t\t}\n\n\t\t\tif (oElement.hasAttribute('data-onscroll-to')) {\n\t\t\t\taAnimateTo = JSON.parse(oElement.dataset.onscrollTo)\n\t\t\t}\n\n\t\t\t/* Set offset */\n\t\t\tif (oElement.hasAttribute('data-onscroll-offset')) {\n\t\t\t\tiOffset = parseInt(oElement.dataset.onscrollOffset)\n\t\t\t}\n\n\t\t\t/* Set distance */\n\t\t\tif (oElement.hasAttribute('data-onscroll-distance')) {\n\t\t\t\tiDistance = parseInt(oElement.dataset.onscrollDistance)\n\t\t\t}\n\n\t\t\t/* Get speed */\n\t\t\tconst fnGetSpeed = () => {\n\t\t\t\treturn (\n\t\t\t\t\t(1 - parseFloat(oElement.dataset.onscrollSpeed)) *\n\t\t\t\t\t(ScrollTrigger.maxScroll(window) - (this.scrollTrigger ? this.scrollTrigger.start : 0))\n\t\t\t\t)\n\t\t\t}\n\n\t\t\t/* Determine auto */\n\t\t\tif (oElement.hasAttribute('data-onscroll-auto')) {\n\t\t\t\toTrigger = oElement.parentElement\n\t\t\t\tiDistance = oElement.offsetHeight - oElement.parentElement.offsetHeight\n\t\t\t}\n\n\t\t\t/* Get offset */\n\t\t\tfunction fnGetOffset() {\n\t\t\t\tif (oElement.hasAttribute('data-onscroll-reverse')) {\n\t\t\t\t\treturn iOffset ? +iOffset : null\n\t\t\t\t} else {\n\t\t\t\t\treturn iOffset ? -iOffset : null\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Get distance */\n\t\t\tfunction fnGetDistance() {\n\t\t\t\tif (oElement.hasAttribute('data-onscroll-auto')) {\n\t\t\t\t\treturn oElement.hasAttribute('data-onscroll-reverse') ? -iDistance : iDistance\n\t\t\t\t} else {\n\t\t\t\t\treturn oElement.hasAttribute('data-onscroll-reverse') ? -iDistance : iDistance\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Apply animations */\n\t\t\tconst fromProperties = {\n\t\t\t\t...aAnimateFrom,\n\t\t\t\tbottom:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-auto') && oElement.hasAttribute('data-onscroll-reverse')\n\t\t\t\t\t\t? 'auto'\n\t\t\t\t\t\t: null,\n\t\t\t\ttop:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-auto') && !oElement.hasAttribute('data-onscroll-reverse')\n\t\t\t\t\t\t? 'auto'\n\t\t\t\t\t\t: null,\n\t\t\t\tx:\n\t\t\t\t\toElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t(oElement.dataset.onscrollDirection === 'x' || oElement.dataset.onscrollDirection === 'xy')\n\t\t\t\t\t\t? fnGetOffset()\n\t\t\t\t\t\t: null,\n\t\t\t\ty:\n\t\t\t\t\t!oElement.hasAttribute('data-onscroll-direction') ||\n\t\t\t\t\t(oElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'y' || oElement.dataset.onscrollDirection === 'xy'))\n\t\t\t\t\t\t? fnGetOffset()\n\t\t\t\t\t\t: null,\n\t\t\t}\n\n\t\t\tconst toProperties = {\n\t\t\t\t...aAnimateTo,\n\t\t\t\tx: () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\toElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'x' || oElement.dataset.onscrollDirection === 'xy')\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (oElement.hasAttribute('data-onscroll-speed')) {\n\t\t\t\t\t\t\treturn fnGetSpeed()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn fnGetDistance()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ty: () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!oElement.hasAttribute('data-onscroll-direction') ||\n\t\t\t\t\t\t(oElement.hasAttribute('data-onscroll-direction') &&\n\t\t\t\t\t\t\t(oElement.dataset.onscrollDirection === 'y' || oElement.dataset.onscrollDirection === 'xy'))\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (oElement.hasAttribute('data-onscroll-speed')) {\n\t\t\t\t\t\t\treturn fnGetSpeed()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn fnGetDistance()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tease: 'none',\n\t\t\t\tscrollTrigger: {\n\t\t\t\t\ttrigger: oElement.dataset.onscrollTrigger\n\t\t\t\t\t\t? document.querySelector(oElement.dataset.onscrollTrigger)\n\t\t\t\t\t\t: oTrigger,\n\t\t\t\t\tstart: oElement.dataset.onscrollStart ? oElement.dataset.onscrollStart : iStart,\n\t\t\t\t\tend: oElement.dataset.onscrollEnd ? oElement.dataset.onscrollEnd : iBottom,\n\t\t\t\t\tinvalidateOnRefresh: true,\n\t\t\t\t\tscrub: true,\n\t\t\t\t\tmarkers: oElement.hasAttribute('data-onscroll-debug') ? true : false,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst animation = matchMedia.add(sScreen, () => {\n\t\t\t\tgsapAnimation = gsap.fromTo(oElement, fromProperties, toProperties)\n\n\t\t\t\t/* Store the ScrollTrigger instance and animation */\n\t\t\t\tthis.scrollTriggers.push(gsapAnimation.scrollTrigger)\n\t\t\t\tthis.animationsData.push({ oElement, fromProperties, toProperties, gsapAnimation })\n\t\t\t})\n\n\t\t\t/* Debug mode */\n\t\t\tif (oElement.hasAttribute('data-onscroll-debug')) {\n\t\t\t\tconsole.group(`OnscrollDetection() debug instance (${iIndex + 1})`)\n\t\t\t\tconsole.log({\n\t\t\t\t\telement: oElement,\n\t\t\t\t\tauto: oElement.hasAttribute('data-onscroll-auto') ? true : false,\n\t\t\t\t\toffset: iOffset,\n\t\t\t\t\tdistance: iDistance,\n\t\t\t\t\tscreen: sScreen,\n\t\t\t\t\tspeed: oElement.hasAttribute('data-onscroll-speed')\n\t\t\t\t\t\t? oElement.dataset.onscrollSpeed +\n\t\t\t\t\t\t  ' calculated at ' +\n\t\t\t\t\t\t  (1 - parseFloat(oElement.dataset.onscrollSpeed)) *\n\t\t\t\t\t\t\t\t(ScrollTrigger.maxScroll(window) - (this.scrollTrigger ? this.scrollTrigger.start : 0))\n\t\t\t\t\t\t: null,\n\t\t\t\t\tdirection: oElement.hasAttribute('data-onscroll-direction')\n\t\t\t\t\t\t? oElement.dataset.onscrollDirection\n\t\t\t\t\t\t: 'y',\n\t\t\t\t\treverse: oElement.hasAttribute('data-onscroll-reverse') ? true : false,\n\t\t\t\t\ttrigger: oTrigger,\n\t\t\t\t\ttriggerStart: iStart,\n\t\t\t\t\ttriggerEnd: iBottom,\n\t\t\t\t\tanimateFrom: oElement.hasAttribute('data-onscroll-to')\n\t\t\t\t\t\t? JSON.parse(oElement.dataset.onscrollFrom)\n\t\t\t\t\t\t: null,\n\t\t\t\t\tanimateTo: oElement.hasAttribute('data-onscroll-to')\n\t\t\t\t\t\t? JSON.parse(oElement.dataset.onscrollTo)\n\t\t\t\t\t\t: null,\n\t\t\t\t})\n\t\t\t\tconsole.groupEnd()\n\t\t\t}\n\t\t})\n\t}\n\n\trefresh() {\n\t\tScrollTrigger.refresh()\n\t}\n\n\trestart() {\n\t\t// Remove existing ScrollTriggers\n\t\tthis.stop()\n\n\t\t// Reinitialize the ScrollTrigger instances\n\t\tScrollTrigger.getAll().forEach((trigger) => trigger.kill())\n\n\t\t// Refresh ScrollTrigger\n\t\tScrollTrigger.refresh()\n\n\t\t// Reapply animations using the stored animation properties\n\t\tthis.init()\n\t}\n\n\tstop(target = null) {\n\t\tif (target) {\n\t\t\tconst index = this.scrollTriggers.indexOf(target)\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.animationsData[index].gsapAnimation.kill()\n\t\t\t\tthis.scrollTriggers.splice(index, 1)\n\t\t\t\tthis.animationsData.splice(index, 1)\n\t\t\t}\n\t\t} else {\n\t\t\tthis.animationsData.forEach(({ gsapAnimation }) => {\n\t\t\t\tgsapAnimation.kill()\n\t\t\t})\n\t\t\tthis.scrollTriggers = [] // Clear the ScrollTrigger instances array\n\t\t\tthis.animationsData = [] // Clear the animations data array\n\t\t}\n\t}\n}\n"],"names":["OnscrollDetection","options","_this","this","init","gsap","utils","toArray","elements","forEach","oElement","iIndex","oTrigger","gsapAnimation","aAnimateFrom","aAnimateTo","iOffset","iDistance","iStart","iBottom","sScreen","screen","matchMedia","hasAttribute","dataset","onscrollScreen","JSON","parse","onscrollFrom","onscrollTo","parseInt","onscrollOffset","onscrollDistance","fnGetSpeed","parseFloat","onscrollSpeed","ScrollTrigger","maxScroll","window","scrollTrigger","start","fnGetOffset","fnGetDistance","parentElement","offsetHeight","fromProperties","_extends","bottom","top","x","onscrollDirection","y","toProperties","ease","trigger","onscrollTrigger","document","querySelector","onscrollStart","end","onscrollEnd","invalidateOnRefresh","scrub","markers","add","fromTo","scrollTriggers","push","animationsData","console","group","log","element","auto","offset","distance","speed","direction","reverse","triggerStart","triggerEnd","animateFrom","animateTo","groupEnd","_proto","prototype","refresh","restart","stop","getAll","kill","target","index","indexOf","splice","_ref"],"mappings":"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"}