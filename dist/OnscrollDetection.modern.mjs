function t(){return t=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},t.apply(this,arguments)}class s{constructor(t={}){this.elements=t.elements||"[data-onscroll]",this.screen=t.screen||"(min-width: 1025px)",this.triggers=new Map,this.scrollingClass=t.scrollingClass||"is-scrolling",this.scrolledClass=t.scrolledClass||"has-scrolled",this.stickyClass=t.stickyClass||"is-sticky",this.stuckClass=t.stuckClass||"has-stuck",this.eventHandlers={},this.autoStart=void 0===t.autoStart||t.autoStart,this.autoStart&&this.init()}init(){gsap.utils.toArray(this.elements).forEach((t,s)=>{const e=this.getTrigger(t),r=this.getScreen(t),i=gsap.matchMedia(),a=this.getFromProperties(t,s),o=this.getToProperties(t,s,e);i.add(r,()=>{const s=gsap.fromTo(t,a,o);this.triggers.set(s.scrollTrigger,{element:t,fromProperties:a,toProperties:o,gsapAnimation:s})}),this.debugMode(t,s)})}start(){this.init()}on(t,s){this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(s)}emit(t,...s){this.eventHandlers[t]&&this.eventHandlers[t].forEach(t=>t(...s))}getTrigger(t){return this.hasAttributes(t,["data-onscroll-auto"])&&!t.hasAttribute("data-onscroll-trigger")?t.parentElement:t.hasAttribute("data-onscroll-trigger")?document.querySelector(t.dataset.onscrollTrigger)||(console.error(`Element specified by data-onscroll-trigger not found: ${t.dataset.onscrollTrigger}`),t):t}getScreen(t){return t.hasAttribute("data-onscroll-screen")?t.dataset.onscrollScreen:this.screen}getFromProperties(s,e){const r=this.getAnimateFrom(s),{offset:i}=this.getOffsetAndDistance(s);return t({},r,{bottom:this.hasAttributes(s,["data-onscroll-auto","data-onscroll-reverse"])?"auto":null,top:this.hasAttributes(s,["data-onscroll-auto"])&&!this.hasAttributes(s,["data-onscroll-reverse"])?"auto":null,x:!this.hasAttributes(s,["data-onscroll-direction"])||"x"!==this.getDirection(s)&&"xy"!==this.getDirection(s)?null:i,y:!this.hasAttributes(s,["data-onscroll-direction"])||this.hasAttributes(s,["data-onscroll-direction"])&&("y"===this.getDirection(s)||"xy"===this.getDirection(s))?i:null})}getToProperties(s,e,r){const i=this.getAnimateTo(s),a=this.getStickyProperties(s),o=this.hasAttributes(s,["data-onscroll-sticky"]),n=s.getAttribute("data-onscroll-call"),l=(t,e)=>{n&&window.dispatchEvent(new CustomEvent(n,{detail:{target:s,direction:1===e?"down":"up",when:t}}))};return t({},i,{x:this.getX(s),y:this.getY(s),ease:"none",scrollTrigger:{trigger:o?s:r,start:this.getStart(s),end:this.getEnd(s),invalidateOnRefresh:!0,pin:a.pin,pinSpacing:a.pinSpacing,scrub:this.getScrub(s),markers:this.hasAttributes(s,["data-onscroll-debug"]),onEnter:({direction:t})=>{s.classList.add(this.scrollingClass,this.scrolledClass),o&&s.classList.add(this.stickyClass,this.stuckClass),l("onEnter",t),this.emit("onEnter",s)},onLeave:({direction:t})=>{s.classList.remove(this.scrollingClass),o&&s.classList.remove(this.stickyClass),l("onLeave",t),this.emit("onLeave",s)},onEnterBack:({direction:t})=>{s.classList.add(this.scrollingClass),o&&s.classList.add(this.stickyClass),l("onEnterBack",t),this.emit("onEnterBack",s)},onLeaveBack:({direction:t})=>{s.classList.remove(this.scrollingClass),o&&s.classList.remove(this.stickyClass),l("onLeaveBack",t),this.emit("onLeaveBack",s)}}})}getStickyProperties(t){return t.hasAttribute("data-onscroll-sticky")?{pin:!0,pinSpacing:!1}:{pin:!1,pinSpacing:!0}}hasAttributes(t,s){return s.every(s=>t.hasAttribute(s))}getAnimateFrom(t){return t.hasAttribute("data-onscroll-from")?JSON.parse(t.dataset.onscrollFrom):[]}getAnimateTo(t){return t.hasAttribute("data-onscroll-to")?JSON.parse(t.dataset.onscrollTo):[]}getOffset(t){return t.hasAttribute("data-onscroll-offset")?parseInt(t.dataset.onscrollOffset):null}getDirection(t){return t.dataset.onscrollDirection}getX(t){return t.hasAttribute("data-onscroll-sticky")?null:!this.hasAttributes(t,["data-onscroll-direction"])||"x"!==this.getDirection(t)&&"xy"!==this.getDirection(t)?void 0:this.getDistanceOrSpeed(t)}getY(t){return t.hasAttribute("data-onscroll-sticky")?null:!this.hasAttributes(t,["data-onscroll-direction"])||this.hasAttributes(t,["data-onscroll-direction"])&&("y"===this.getDirection(t)||"xy"===this.getDirection(t))?this.getDistanceOrSpeed(t):void 0}getOffsetAndDistance(t){if(t.hasAttribute("data-onscroll-sticky"))return{offset:null,distance:null};let s=null,e=null;const r=this.getTrigger(t).offsetHeight;if(t.hasAttribute("data-onscroll-offset")){const[i,a]=t.dataset.onscrollOffset.split(",");s=i.trim().endsWith("%")?parseFloat(i)/100*r:parseFloat(i),e=a.trim().endsWith("%")?parseFloat(a)/100*r:parseFloat(a)}return{offset:s,distance:e}}getDistanceOrSpeed(t){const{distance:s}=this.getOffsetAndDistance(t),e=window.innerHeight;let r=t.dataset.onscrollSpeed,i=0;if(r&&r.includes(",")){const[t,s]=r.split(",").map(parseFloat);r=t,i=s/100*e,r<0&&(i*=-1)}else r=parseFloat(r||"0");if(this.hasAttributes(t,["data-onscroll-auto"])){const s=this.getTrigger(t),e=Math.abs(s.offsetHeight-t.offsetHeight);return this.hasAttributes(t,["data-onscroll-reverse"])?-e:e}if(this.hasAttributes(t,["data-onscroll-speed"])){const s=r*t.offsetHeight+i;return this.hasAttributes(t,["data-onscroll-reverse"])?-s:s}if(null!==s)return this.hasAttributes(t,["data-onscroll-reverse"])?-s:s}getScrub(t){return!this.hasAttributes(t,["data-onscroll-delay"])||parseInt(t.dataset.onscrollDelay)}getStart(t){if(t.hasAttribute("data-onscroll-sticky")){let s=0;if(t.hasAttribute("data-onscroll-offset")){const[e,r]=t.dataset.onscrollOffset.split(",");s=parseFloat(e)}return(t.dataset.onscrollStart?t.dataset.onscrollStart:"top top")+"+="+s}return t.dataset.onscrollStart?t.dataset.onscrollStart:"top bottom"}getEnd(t){if(t.hasAttribute("data-onscroll-sticky")){const s=this.getTrigger(t);let e=0;if(t.hasAttribute("data-onscroll-offset")){const[s,r]=t.dataset.onscrollOffset.split(",");e=parseFloat(r)}return"+="+(s.clientHeight-t.clientHeight-e)}if(this.hasAttributes(t,["data-onscroll-speed"])&&!t.hasAttribute("data-onscroll-end")){const s=this.getDistanceOrSpeed(t);return this.getOffsetAndDistance(t),`bottom${s>=0?"+=":"-="}${Math.abs(s)} top`}return t.dataset.onscrollEnd?t.dataset.onscrollEnd:"bottom top"}debugMode(t,s){if(this.hasAttributes(t,["data-onscroll-debug"])){const{offset:e}=this.getOffsetAndDistance(t);let r,i;this.hasAttributes(t,["data-onscroll-speed"])&&([r,i]=t.dataset.onscrollSpeed.split(",")),console.group(`OnscrollDetection() debug instance (#${s+1})`),console.log({element:t,trigger:this.getTrigger(t),triggerStart:this.getStart(t),triggerEnd:this.getEnd(t),auto:this.hasAttributes(t,["data-onscroll-auto"]),offsetBefore:e,offsetAfter:this.getDistanceOrSpeed(t),delay:this.getScrub(t),screen:this.getScreen(t),speed:this.hasAttributes(t,["data-onscroll-speed"])?parseFloat(r*t.clientHeight+i/100*window.innerHeight)+" ("+parseFloat(r)+"x element height + "+parseFloat(i)+"% of the viewport height)":null,direction:this.hasAttributes(t,["data-onscroll-direction"])?t.dataset.onscrollDirection:"y",reverse:this.hasAttributes(t,["data-onscroll-reverse"]),sticky:!!this.hasAttributes(t,["data-onscroll-sticky"]),animateFrom:this.getAnimateFrom(t),animateTo:this.getAnimateTo(t),customEvent:this.hasAttributes(t,["data-onscroll-call"])?t.getAttribute("data-onscroll-call"):null}),console.groupEnd()}}fetch(t){if("number"==typeof t)return Array.from(this.triggers.keys())[t];{let s=null;return this.triggers.forEach((e,r)=>{e.element===t&&(s=r)}),s}}refresh(){ScrollTrigger.refresh(),this.emit("refresh")}restart(){this.stop(),ScrollTrigger.getAll().forEach(t=>t.kill()),ScrollTrigger.refresh(),this.init(),this.emit("restart")}stop(t=null){if(t){const s=this.triggers.get(t);s&&(s.gsapAnimation.kill(),this.triggers.delete(t))}else this.triggers.forEach(({gsapAnimation:t})=>{t.kill()}),this.triggers.clear();this.emit("stop",t)}update(s,e,r){const i=this.triggers.get(s);if(i){i.gsapAnimation.kill();const s=gsap.fromTo(i.element,e,r);this.triggers.set(s.scrollTrigger,t({},i,{fromProperties:e,toProperties:r,gsapAnimation:s}))}}destroy(){this.stop(),this.triggers=null}}export{s as default};
//# sourceMappingURL=OnscrollDetection.modern.mjs.map
